"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = mallRoutes;
var _express = require("express");
var _asyncHandler = _interopRequireDefault(require("@global-common/server/routes/helper/asyncHandler"));
var _userGuard = require("@diary-server/routes/middleware/userGuard");
var _validator = require("@global-common/utils/validator");
var _joi = _interopRequireDefault(require("joi"));
var _mallController = require("@diary-server/controller/mall-controller");
var _utils = require("@global-common/server/routes/helper/utils");
var _localUpload = require("@global-common/middleware/local-upload");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function mallRoutes(router = (0, _express.Router)()) {
  // 쇼핑몰 사이즈 목록
  router.get('/mall/size', (0, _asyncHandler.default)(getSizeList));
  // 쇼핑몰 카테고리 등록
  router.post('/mall/category', _userGuard.diaryGuard, (0, _asyncHandler.default)(postMallCategory));
  // 쇼핑몰 카테고리 목록
  router.get('/mall/category', _userGuard.diaryGuard, (0, _asyncHandler.default)(getMallCategory));
  // 쇼핑몰 상품 등록
  router.post('/mall/item', _userGuard.diaryGuard, _localUpload.localUpload.single('file'), (0, _asyncHandler.default)(postMallItem));
  // 쇼핑몰 리스트 조회
  router.get('/mall/item', _userGuard.diaryGuard, (0, _asyncHandler.default)(getMallList));
  // 쇼핑몰 상풍 상세
  router.get('/mall/item/:id', _userGuard.diaryGuard, (0, _asyncHandler.default)(getMallDetail));
  async function getSizeList(req, res) {
    const sizeList = [{
      id: 1,
      name: 'S'
    }, {
      id: 2,
      name: 'M'
    }, {
      id: 3,
      name: 'L'
    }, {
      id: 4,
      name: 'XL'
    }, {
      id: 5,
      name: 'XXL'
    }];
    res.json(sizeList);
  }
  async function postMallCategory(req, res) {
    const {
      body
    } = req;
    const {
      name
    } = (0, _validator.validateInputData)(body, {
      name: _joi.default.string().required()
    });
    await (0, _mallController.saveCategory)(name);
    (0, _utils.sendOk)(res);
  }
  async function getMallCategory(req, res) {
    const result = await (0, _mallController.fetchCategoryList)();
    res.json(result);
  }
  async function postMallItem(req, res) {
    const {
      body
    } = req;
    const param = (0, _validator.validateInputData)(body, {
      categoryId: _joi.default.number().required(),
      name: _joi.default.string().required(),
      price: _joi.default.number().required(),
      description: _joi.default.string().required()
    });
    await (0, _mallController.saveItem)(param, req.file);
    (0, _utils.sendOk)(res);
  }
  async function getMallList(req, res) {
    const {
      query
    } = req;
    const param = (0, _validator.validateInputData)(query, {
      categoryId: _joi.default.number(),
      page: _joi.default.number()
    });
    const result = await (0, _mallController.fetchItemList)(param);
    res.json(result);
  }
  async function getMallDetail(req, res) {
    const result = await (0, _mallController.fetchItemDetail)(req.params.id);
    res.json(result);
  }
  return router;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtYWxsUm91dGVzIiwicm91dGVyIiwiUm91dGVyIiwiZ2V0IiwiYXN5bmNIYW5kbGVyIiwiZ2V0U2l6ZUxpc3QiLCJwb3N0IiwiZGlhcnlHdWFyZCIsInBvc3RNYWxsQ2F0ZWdvcnkiLCJnZXRNYWxsQ2F0ZWdvcnkiLCJsb2NhbFVwbG9hZCIsInNpbmdsZSIsInBvc3RNYWxsSXRlbSIsImdldE1hbGxMaXN0IiwiZ2V0TWFsbERldGFpbCIsInJlcSIsInJlcyIsInNpemVMaXN0IiwiaWQiLCJuYW1lIiwianNvbiIsImJvZHkiLCJ2YWxpZGF0ZUlucHV0RGF0YSIsIkpvaSIsInN0cmluZyIsInJlcXVpcmVkIiwic2F2ZUNhdGVnb3J5Iiwic2VuZE9rIiwicmVzdWx0IiwiZmV0Y2hDYXRlZ29yeUxpc3QiLCJwYXJhbSIsImNhdGVnb3J5SWQiLCJudW1iZXIiLCJwcmljZSIsImRlc2NyaXB0aW9uIiwic2F2ZUl0ZW0iLCJmaWxlIiwicXVlcnkiLCJwYWdlIiwiZmV0Y2hJdGVtTGlzdCIsImZldGNoSXRlbURldGFpbCIsInBhcmFtcyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9kaWFyeS1zZXJ2ZXIvcm91dGVzL2RlZmF1bHQtbG9hZC9tYWxsLXJvdXRlcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdleHByZXNzJ1xyXG5pbXBvcnQgYXN5bmNIYW5kbGVyIGZyb20gJ0BnbG9iYWwtY29tbW9uL3NlcnZlci9yb3V0ZXMvaGVscGVyL2FzeW5jSGFuZGxlcidcclxuaW1wb3J0IHsgYWRtaW5HdWFyZCwgZGlhcnlHdWFyZCB9IGZyb20gJ0BkaWFyeS1zZXJ2ZXIvcm91dGVzL21pZGRsZXdhcmUvdXNlckd1YXJkJ1xyXG5pbXBvcnQgeyB2YWxpZGF0ZUlucHV0RGF0YSB9IGZyb20gJ0BnbG9iYWwtY29tbW9uL3V0aWxzL3ZhbGlkYXRvcidcclxuaW1wb3J0IEpvaSBmcm9tICdqb2knXHJcbmltcG9ydCB7XHJcbiAgZmV0Y2hDYXRlZ29yeUxpc3QsXHJcbiAgZmV0Y2hJdGVtRGV0YWlsLFxyXG4gIGZldGNoSXRlbUxpc3QsXHJcbiAgc2F2ZUNhdGVnb3J5LFxyXG4gIHNhdmVJdGVtLFxyXG59IGZyb20gJ0BkaWFyeS1zZXJ2ZXIvY29udHJvbGxlci9tYWxsLWNvbnRyb2xsZXInXHJcbmltcG9ydCB7IHNlbmRPayB9IGZyb20gJ0BnbG9iYWwtY29tbW9uL3NlcnZlci9yb3V0ZXMvaGVscGVyL3V0aWxzJ1xyXG5pbXBvcnQgeyBsb2NhbFVwbG9hZCB9IGZyb20gJ0BnbG9iYWwtY29tbW9uL21pZGRsZXdhcmUvbG9jYWwtdXBsb2FkJ1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbWFsbFJvdXRlcyAocm91dGVyID0gUm91dGVyKCkpIHtcclxuICAvLyDsh7ztlZHrqrAg7IKs7J207KaIIOuqqeuhnVxyXG4gIHJvdXRlci5nZXQoJy9tYWxsL3NpemUnLCBhc3luY0hhbmRsZXIoZ2V0U2l6ZUxpc3QpKVxyXG4gIC8vIOyHvO2VkeuqsCDsubTthYzqs6Drpqwg65Ox66GdXHJcbiAgcm91dGVyLnBvc3QoJy9tYWxsL2NhdGVnb3J5JywgZGlhcnlHdWFyZCwgYXN5bmNIYW5kbGVyKHBvc3RNYWxsQ2F0ZWdvcnkpKVxyXG4gIC8vIOyHvO2VkeuqsCDsubTthYzqs6Drpqwg66qp66GdXHJcbiAgcm91dGVyLmdldCgnL21hbGwvY2F0ZWdvcnknLCBkaWFyeUd1YXJkLCBhc3luY0hhbmRsZXIoZ2V0TWFsbENhdGVnb3J5KSlcclxuICAvLyDsh7ztlZHrqrAg7IOB7ZKIIOuTseuhnVxyXG4gIHJvdXRlci5wb3N0KCcvbWFsbC9pdGVtJywgZGlhcnlHdWFyZCwgbG9jYWxVcGxvYWQuc2luZ2xlKCdmaWxlJyksIGFzeW5jSGFuZGxlcihwb3N0TWFsbEl0ZW0pKVxyXG4gIC8vIOyHvO2VkeuqsCDrpqzsiqTtirgg7KGw7ZqMXHJcbiAgcm91dGVyLmdldCgnL21hbGwvaXRlbScsIGRpYXJ5R3VhcmQsIGFzeW5jSGFuZGxlcihnZXRNYWxsTGlzdCkpXHJcbiAgLy8g7Ie87ZWR66qwIOyDge2SjSDsg4HshLhcclxuICByb3V0ZXIuZ2V0KCcvbWFsbC9pdGVtLzppZCcsIGRpYXJ5R3VhcmQsIGFzeW5jSGFuZGxlcihnZXRNYWxsRGV0YWlsKSlcclxuXHJcbiAgYXN5bmMgZnVuY3Rpb24gZ2V0U2l6ZUxpc3QgKHJlcSwgcmVzKSB7XHJcbiAgICBjb25zdCBzaXplTGlzdCA9IFtcclxuICAgICAgeyBpZDogMSwgbmFtZTogJ1MnIH0sXHJcbiAgICAgIHsgaWQ6IDIsIG5hbWU6ICdNJyB9LFxyXG4gICAgICB7IGlkOiAzLCBuYW1lOiAnTCcgfSxcclxuICAgICAgeyBpZDogNCwgbmFtZTogJ1hMJyB9LFxyXG4gICAgICB7IGlkOiA1LCBuYW1lOiAnWFhMJyB9LFxyXG4gICAgXVxyXG5cclxuICAgIHJlcy5qc29uKHNpemVMaXN0KVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZnVuY3Rpb24gcG9zdE1hbGxDYXRlZ29yeSAocmVxLCByZXMpIHtcclxuICAgIGNvbnN0IHsgYm9keSB9ID0gcmVxXHJcblxyXG4gICAgY29uc3QgeyBuYW1lIH0gPSB2YWxpZGF0ZUlucHV0RGF0YShib2R5LCB7XHJcbiAgICAgIG5hbWU6IEpvaS5zdHJpbmcoKS5yZXF1aXJlZCgpLFxyXG4gICAgfSlcclxuXHJcbiAgICBhd2FpdCBzYXZlQ2F0ZWdvcnkobmFtZSlcclxuXHJcbiAgICBzZW5kT2socmVzKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZnVuY3Rpb24gZ2V0TWFsbENhdGVnb3J5IChyZXEsIHJlcykge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZmV0Y2hDYXRlZ29yeUxpc3QoKVxyXG5cclxuICAgIHJlcy5qc29uKHJlc3VsdClcclxuICB9XHJcblxyXG4gIGFzeW5jIGZ1bmN0aW9uIHBvc3RNYWxsSXRlbSAocmVxLCByZXMpIHtcclxuICAgIGNvbnN0IHsgYm9keSB9ID0gcmVxXHJcblxyXG4gICAgY29uc3QgcGFyYW0gPSB2YWxpZGF0ZUlucHV0RGF0YShib2R5LCB7XHJcbiAgICAgIGNhdGVnb3J5SWQ6IEpvaS5udW1iZXIoKS5yZXF1aXJlZCgpLFxyXG4gICAgICBuYW1lOiBKb2kuc3RyaW5nKCkucmVxdWlyZWQoKSxcclxuICAgICAgcHJpY2U6IEpvaS5udW1iZXIoKS5yZXF1aXJlZCgpLFxyXG4gICAgICBkZXNjcmlwdGlvbjogSm9pLnN0cmluZygpLnJlcXVpcmVkKCksXHJcbiAgICB9KVxyXG5cclxuICAgIGF3YWl0IHNhdmVJdGVtKHBhcmFtLCByZXEuZmlsZSlcclxuXHJcbiAgICBzZW5kT2socmVzKVxyXG4gIH1cclxuICBhc3luYyBmdW5jdGlvbiBnZXRNYWxsTGlzdCAocmVxLCByZXMpIHtcclxuICAgIGNvbnN0IHsgcXVlcnkgfSA9IHJlcVxyXG5cclxuICAgIGNvbnN0IHBhcmFtID0gdmFsaWRhdGVJbnB1dERhdGEocXVlcnksIHtcclxuICAgICAgY2F0ZWdvcnlJZDogSm9pLm51bWJlcigpLFxyXG4gICAgICBwYWdlOiBKb2kubnVtYmVyKCksXHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZldGNoSXRlbUxpc3QocGFyYW0pXHJcblxyXG4gICAgcmVzLmpzb24ocmVzdWx0KVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZnVuY3Rpb24gZ2V0TWFsbERldGFpbCAocmVxLCByZXMpIHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZldGNoSXRlbURldGFpbChyZXEucGFyYW1zLmlkKVxyXG5cclxuICAgIHJlcy5qc29uKHJlc3VsdClcclxuICB9XHJcblxyXG4gIHJldHVybiByb3V0ZXJcclxufVxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBQ0E7QUFBb0U7QUFFckQsU0FBU0EsVUFBVSxDQUFFQyxNQUFNLEdBQUcsSUFBQUMsZUFBTSxHQUFFLEVBQUU7RUFDckQ7RUFDQUQsTUFBTSxDQUFDRSxHQUFHLENBQUMsWUFBWSxFQUFFLElBQUFDLHFCQUFZLEVBQUNDLFdBQVcsQ0FBQyxDQUFDO0VBQ25EO0VBQ0FKLE1BQU0sQ0FBQ0ssSUFBSSxDQUFDLGdCQUFnQixFQUFFQyxxQkFBVSxFQUFFLElBQUFILHFCQUFZLEVBQUNJLGdCQUFnQixDQUFDLENBQUM7RUFDekU7RUFDQVAsTUFBTSxDQUFDRSxHQUFHLENBQUMsZ0JBQWdCLEVBQUVJLHFCQUFVLEVBQUUsSUFBQUgscUJBQVksRUFBQ0ssZUFBZSxDQUFDLENBQUM7RUFDdkU7RUFDQVIsTUFBTSxDQUFDSyxJQUFJLENBQUMsWUFBWSxFQUFFQyxxQkFBVSxFQUFFRyx3QkFBVyxDQUFDQyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsSUFBQVAscUJBQVksRUFBQ1EsWUFBWSxDQUFDLENBQUM7RUFDN0Y7RUFDQVgsTUFBTSxDQUFDRSxHQUFHLENBQUMsWUFBWSxFQUFFSSxxQkFBVSxFQUFFLElBQUFILHFCQUFZLEVBQUNTLFdBQVcsQ0FBQyxDQUFDO0VBQy9EO0VBQ0FaLE1BQU0sQ0FBQ0UsR0FBRyxDQUFDLGdCQUFnQixFQUFFSSxxQkFBVSxFQUFFLElBQUFILHFCQUFZLEVBQUNVLGFBQWEsQ0FBQyxDQUFDO0VBRXJFLGVBQWVULFdBQVcsQ0FBRVUsR0FBRyxFQUFFQyxHQUFHLEVBQUU7SUFDcEMsTUFBTUMsUUFBUSxHQUFHLENBQ2Y7TUFBRUMsRUFBRSxFQUFFLENBQUM7TUFBRUMsSUFBSSxFQUFFO0lBQUksQ0FBQyxFQUNwQjtNQUFFRCxFQUFFLEVBQUUsQ0FBQztNQUFFQyxJQUFJLEVBQUU7SUFBSSxDQUFDLEVBQ3BCO01BQUVELEVBQUUsRUFBRSxDQUFDO01BQUVDLElBQUksRUFBRTtJQUFJLENBQUMsRUFDcEI7TUFBRUQsRUFBRSxFQUFFLENBQUM7TUFBRUMsSUFBSSxFQUFFO0lBQUssQ0FBQyxFQUNyQjtNQUFFRCxFQUFFLEVBQUUsQ0FBQztNQUFFQyxJQUFJLEVBQUU7SUFBTSxDQUFDLENBQ3ZCO0lBRURILEdBQUcsQ0FBQ0ksSUFBSSxDQUFDSCxRQUFRLENBQUM7RUFDcEI7RUFFQSxlQUFlVCxnQkFBZ0IsQ0FBRU8sR0FBRyxFQUFFQyxHQUFHLEVBQUU7SUFDekMsTUFBTTtNQUFFSztJQUFLLENBQUMsR0FBR04sR0FBRztJQUVwQixNQUFNO01BQUVJO0lBQUssQ0FBQyxHQUFHLElBQUFHLDRCQUFpQixFQUFDRCxJQUFJLEVBQUU7TUFDdkNGLElBQUksRUFBRUksWUFBRyxDQUFDQyxNQUFNLEVBQUUsQ0FBQ0MsUUFBUTtJQUM3QixDQUFDLENBQUM7SUFFRixNQUFNLElBQUFDLDRCQUFZLEVBQUNQLElBQUksQ0FBQztJQUV4QixJQUFBUSxhQUFNLEVBQUNYLEdBQUcsQ0FBQztFQUNiO0VBRUEsZUFBZVAsZUFBZSxDQUFFTSxHQUFHLEVBQUVDLEdBQUcsRUFBRTtJQUN4QyxNQUFNWSxNQUFNLEdBQUcsTUFBTSxJQUFBQyxpQ0FBaUIsR0FBRTtJQUV4Q2IsR0FBRyxDQUFDSSxJQUFJLENBQUNRLE1BQU0sQ0FBQztFQUNsQjtFQUVBLGVBQWVoQixZQUFZLENBQUVHLEdBQUcsRUFBRUMsR0FBRyxFQUFFO0lBQ3JDLE1BQU07TUFBRUs7SUFBSyxDQUFDLEdBQUdOLEdBQUc7SUFFcEIsTUFBTWUsS0FBSyxHQUFHLElBQUFSLDRCQUFpQixFQUFDRCxJQUFJLEVBQUU7TUFDcENVLFVBQVUsRUFBRVIsWUFBRyxDQUFDUyxNQUFNLEVBQUUsQ0FBQ1AsUUFBUSxFQUFFO01BQ25DTixJQUFJLEVBQUVJLFlBQUcsQ0FBQ0MsTUFBTSxFQUFFLENBQUNDLFFBQVEsRUFBRTtNQUM3QlEsS0FBSyxFQUFFVixZQUFHLENBQUNTLE1BQU0sRUFBRSxDQUFDUCxRQUFRLEVBQUU7TUFDOUJTLFdBQVcsRUFBRVgsWUFBRyxDQUFDQyxNQUFNLEVBQUUsQ0FBQ0MsUUFBUTtJQUNwQyxDQUFDLENBQUM7SUFFRixNQUFNLElBQUFVLHdCQUFRLEVBQUNMLEtBQUssRUFBRWYsR0FBRyxDQUFDcUIsSUFBSSxDQUFDO0lBRS9CLElBQUFULGFBQU0sRUFBQ1gsR0FBRyxDQUFDO0VBQ2I7RUFDQSxlQUFlSCxXQUFXLENBQUVFLEdBQUcsRUFBRUMsR0FBRyxFQUFFO0lBQ3BDLE1BQU07TUFBRXFCO0lBQU0sQ0FBQyxHQUFHdEIsR0FBRztJQUVyQixNQUFNZSxLQUFLLEdBQUcsSUFBQVIsNEJBQWlCLEVBQUNlLEtBQUssRUFBRTtNQUNyQ04sVUFBVSxFQUFFUixZQUFHLENBQUNTLE1BQU0sRUFBRTtNQUN4Qk0sSUFBSSxFQUFFZixZQUFHLENBQUNTLE1BQU07SUFDbEIsQ0FBQyxDQUFDO0lBRUYsTUFBTUosTUFBTSxHQUFHLE1BQU0sSUFBQVcsNkJBQWEsRUFBQ1QsS0FBSyxDQUFDO0lBRXpDZCxHQUFHLENBQUNJLElBQUksQ0FBQ1EsTUFBTSxDQUFDO0VBQ2xCO0VBRUEsZUFBZWQsYUFBYSxDQUFFQyxHQUFHLEVBQUVDLEdBQUcsRUFBRTtJQUN0QyxNQUFNWSxNQUFNLEdBQUcsTUFBTSxJQUFBWSwrQkFBZSxFQUFDekIsR0FBRyxDQUFDMEIsTUFBTSxDQUFDdkIsRUFBRSxDQUFDO0lBRW5ERixHQUFHLENBQUNJLElBQUksQ0FBQ1EsTUFBTSxDQUFDO0VBQ2xCO0VBRUEsT0FBTzNCLE1BQU07QUFDZiJ9