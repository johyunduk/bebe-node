"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.loadBabyList = loadBabyList;
exports.modifyBaby = modifyBaby;
exports.removeBaby = removeBaby;
exports.saveBaby = saveBaby;
exports.saveBabyFace = saveBabyFace;
var _userBaby = _interopRequireDefault(require("@global-common/db/model/user-baby"));
var _httpError = require("@global-common/error/http-error");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
async function loadBabyList(userId) {
  const list = await (0, _userBaby.default)().findAll({
    where: {
      userId
    },
    order: [['id', 'DESC']],
    raw: true
  });
  return list.map(baby => {
    return {
      ...baby,
      face: baby.face ? `https://api.mybebe.net/uploads/images/${baby.face}` : null
    };
  });
}
async function saveBaby(params, userId) {
  await (0, _userBaby.default)().create({
    ...params,
    userId
  });
}
async function modifyBaby(params, id) {
  const baby = await (0, _userBaby.default)().findOne({
    where: {
      id
    }
  });
  if (!baby) throw new _httpError.BadRequest(_httpError.NO_DATA, '해당 아이가 없습니다.');
  await baby.update(params);
}
async function removeBaby(id) {
  await (0, _userBaby.default)().destroy({
    where: {
      id
    }
  });
}
async function saveBabyFace(userId, babyId, file) {
  const baby = await (0, _userBaby.default)().findOne({
    id: babyId
  });
  if (!baby) throw new _httpError.BadRequest(_httpError.NO_DATA, '해당 아이가 없습니다.');
  const fileName = file.filename;
  await baby.update({
    face: fileName
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJsb2FkQmFieUxpc3QiLCJ1c2VySWQiLCJsaXN0IiwiVXNlckJhYnkiLCJmaW5kQWxsIiwid2hlcmUiLCJvcmRlciIsInJhdyIsIm1hcCIsImJhYnkiLCJmYWNlIiwic2F2ZUJhYnkiLCJwYXJhbXMiLCJjcmVhdGUiLCJtb2RpZnlCYWJ5IiwiaWQiLCJmaW5kT25lIiwiQmFkUmVxdWVzdCIsIk5PX0RBVEEiLCJ1cGRhdGUiLCJyZW1vdmVCYWJ5IiwiZGVzdHJveSIsInNhdmVCYWJ5RmFjZSIsImJhYnlJZCIsImZpbGUiLCJmaWxlTmFtZSIsImZpbGVuYW1lIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2RpYXJ5LXNlcnZlci9jb250cm9sbGVyL2JhYnktY29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVXNlckJhYnkgZnJvbSAnQGdsb2JhbC1jb21tb24vZGIvbW9kZWwvdXNlci1iYWJ5J1xyXG5pbXBvcnQgeyBCYWRSZXF1ZXN0LCBOT19EQVRBIH0gZnJvbSAnQGdsb2JhbC1jb21tb24vZXJyb3IvaHR0cC1lcnJvcidcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkQmFieUxpc3QgKHVzZXJJZDogbnVtYmVyKSB7XHJcbiAgY29uc3QgbGlzdCA9IGF3YWl0IFVzZXJCYWJ5KCkuZmluZEFsbCh7XHJcbiAgICB3aGVyZToge1xyXG4gICAgICB1c2VySWQsXHJcbiAgICB9LFxyXG4gICAgb3JkZXI6IFtbJ2lkJywgJ0RFU0MnXV0sXHJcbiAgICByYXc6IHRydWUsXHJcbiAgfSlcclxuXHJcbiAgcmV0dXJuIGxpc3QubWFwKGJhYnkgPT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgLi4uYmFieSxcclxuICAgICAgZmFjZTogYmFieS5mYWNlID8gYGh0dHBzOi8vYXBpLm15YmViZS5uZXQvdXBsb2Fkcy9pbWFnZXMvJHtiYWJ5LmZhY2V9YCA6IG51bGwsXHJcbiAgICB9XHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVCYWJ5IChwYXJhbXMsIHVzZXJJZCkge1xyXG4gIGF3YWl0IFVzZXJCYWJ5KCkuY3JlYXRlKHtcclxuICAgIC4uLnBhcmFtcyxcclxuICAgIHVzZXJJZCxcclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbW9kaWZ5QmFieSAocGFyYW1zLCBpZCkge1xyXG4gIGNvbnN0IGJhYnkgPSBhd2FpdCBVc2VyQmFieSgpLmZpbmRPbmUoeyB3aGVyZTogeyBpZCB9IH0pXHJcblxyXG4gIGlmICghYmFieSkgdGhyb3cgbmV3IEJhZFJlcXVlc3QoTk9fREFUQSwgJ+2VtOuLuSDslYTsnbTqsIAg7JeG7Iq164uI64ukLicpXHJcblxyXG4gIGF3YWl0IGJhYnkudXBkYXRlKHBhcmFtcylcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUJhYnkgKGlkKSB7XHJcbiAgYXdhaXQgVXNlckJhYnkoKS5kZXN0cm95KHtcclxuICAgIHdoZXJlOiB7XHJcbiAgICAgIGlkLFxyXG4gICAgfSxcclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUJhYnlGYWNlICh1c2VySWQsIGJhYnlJZCwgZmlsZSkge1xyXG4gIGNvbnN0IGJhYnkgPSBhd2FpdCBVc2VyQmFieSgpLmZpbmRPbmUoeyBpZDogYmFieUlkIH0pXHJcblxyXG4gIGlmICghYmFieSkgdGhyb3cgbmV3IEJhZFJlcXVlc3QoTk9fREFUQSwgJ+2VtOuLuSDslYTsnbTqsIAg7JeG7Iq164uI64ukLicpXHJcblxyXG4gIGNvbnN0IGZpbGVOYW1lID0gZmlsZS5maWxlbmFtZVxyXG5cclxuICBhd2FpdCBiYWJ5LnVwZGF0ZSh7IGZhY2U6IGZpbGVOYW1lIH0pXHJcbn1cclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUFxRTtBQUU5RCxlQUFlQSxZQUFZLENBQUVDLE1BQWMsRUFBRTtFQUNsRCxNQUFNQyxJQUFJLEdBQUcsTUFBTSxJQUFBQyxpQkFBUSxHQUFFLENBQUNDLE9BQU8sQ0FBQztJQUNwQ0MsS0FBSyxFQUFFO01BQ0xKO0lBQ0YsQ0FBQztJQUNESyxLQUFLLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztJQUN2QkMsR0FBRyxFQUFFO0VBQ1AsQ0FBQyxDQUFDO0VBRUYsT0FBT0wsSUFBSSxDQUFDTSxHQUFHLENBQUNDLElBQUksSUFBSTtJQUN0QixPQUFPO01BQ0wsR0FBR0EsSUFBSTtNQUNQQyxJQUFJLEVBQUVELElBQUksQ0FBQ0MsSUFBSSxHQUFJLHlDQUF3Q0QsSUFBSSxDQUFDQyxJQUFLLEVBQUMsR0FBRztJQUMzRSxDQUFDO0VBQ0gsQ0FBQyxDQUFDO0FBQ0o7QUFFTyxlQUFlQyxRQUFRLENBQUVDLE1BQU0sRUFBRVgsTUFBTSxFQUFFO0VBQzlDLE1BQU0sSUFBQUUsaUJBQVEsR0FBRSxDQUFDVSxNQUFNLENBQUM7SUFDdEIsR0FBR0QsTUFBTTtJQUNUWDtFQUNGLENBQUMsQ0FBQztBQUNKO0FBRU8sZUFBZWEsVUFBVSxDQUFFRixNQUFNLEVBQUVHLEVBQUUsRUFBRTtFQUM1QyxNQUFNTixJQUFJLEdBQUcsTUFBTSxJQUFBTixpQkFBUSxHQUFFLENBQUNhLE9BQU8sQ0FBQztJQUFFWCxLQUFLLEVBQUU7TUFBRVU7SUFBRztFQUFFLENBQUMsQ0FBQztFQUV4RCxJQUFJLENBQUNOLElBQUksRUFBRSxNQUFNLElBQUlRLHFCQUFVLENBQUNDLGtCQUFPLEVBQUUsY0FBYyxDQUFDO0VBRXhELE1BQU1ULElBQUksQ0FBQ1UsTUFBTSxDQUFDUCxNQUFNLENBQUM7QUFDM0I7QUFFTyxlQUFlUSxVQUFVLENBQUVMLEVBQUUsRUFBRTtFQUNwQyxNQUFNLElBQUFaLGlCQUFRLEdBQUUsQ0FBQ2tCLE9BQU8sQ0FBQztJQUN2QmhCLEtBQUssRUFBRTtNQUNMVTtJQUNGO0VBQ0YsQ0FBQyxDQUFDO0FBQ0o7QUFFTyxlQUFlTyxZQUFZLENBQUVyQixNQUFNLEVBQUVzQixNQUFNLEVBQUVDLElBQUksRUFBRTtFQUN4RCxNQUFNZixJQUFJLEdBQUcsTUFBTSxJQUFBTixpQkFBUSxHQUFFLENBQUNhLE9BQU8sQ0FBQztJQUFFRCxFQUFFLEVBQUVRO0VBQU8sQ0FBQyxDQUFDO0VBRXJELElBQUksQ0FBQ2QsSUFBSSxFQUFFLE1BQU0sSUFBSVEscUJBQVUsQ0FBQ0Msa0JBQU8sRUFBRSxjQUFjLENBQUM7RUFFeEQsTUFBTU8sUUFBUSxHQUFHRCxJQUFJLENBQUNFLFFBQVE7RUFFOUIsTUFBTWpCLElBQUksQ0FBQ1UsTUFBTSxDQUFDO0lBQUVULElBQUksRUFBRWU7RUFBUyxDQUFDLENBQUM7QUFDdkMifQ==